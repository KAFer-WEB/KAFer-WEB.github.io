<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>KAFer - ログイン / 新規登録</title>
    
    <!-- Asset paths updated for the new file structure -->
    <link id="favicon" rel="icon" href="assets/icons/icon.png" type="image/png">
    <link rel="stylesheet" href="assets/css/global.css">
    <link rel="stylesheet" href="assets/css/auth.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Manifest path should be absolute from the root directory -->
    <link rel="manifest" href="/manifest.webmanifest">
</head>
<body class="app-container index-page">
    <header class="app-header">
        <div class="logo"><h1>KAFer</h1></div>
    </header>
    <div class="main-content-wrapper">
        <main class="container">
            <div class="content-section">
                <h2><i class="fas fa-lock"></i> ログイン / 新規登録</h2>
                <div id="message-area" class="message"></div>

                <!-- PWA mode check message area -->
                <div id="pwa-message-area" class="message info" style="display: none;">
                    <p style="font-weight: bold;">このサイトはアプリとして開く必要があります。</p>
                    <p style="font-size: 0.9em; margin-top: 8px;">
                        <strong>Android:</strong> 右上のメニューから「アプリをインストール」または「ホーム画面に追加」を選択してください。<br>
                        <strong>iOS:</strong> 共有ボタン <i class="fas fa-share-square"></i> から「ホーム画面に追加」を選択してください。
                    </p>
                </div>

                <div id="auth-forms-wrapper">
                    <div class="card login-card">
                        <div class="card-header">既存アカウントでログイン</div>
                        <form id="login-form">
                            <div class="form-group">
                                <label for="login-kaferId"><i class="fas fa-id-card"></i> KAFer ID</label>
                                <input type="text" id="login-kaferId" required pattern="[0-9]{4}" title="4桁の数字を入力してください">
                            </div>
                            <div class="form-group">
                                <label for="login-password"><i class="fas fa-key"></i> パスワード</label>
                                <input type="password" id="login-password" required>
                            </div>
                            <button type="submit" class="btn"><i class="fas fa-sign-in-alt"></i> ログイン</button>
                        </form>
                    </div>
                    <div class="card register-card">
                        <div class="card-header">
                            新規アカウント登録
                            <button id="toggle-register-form-btn" class="btn btn-sm" style="float: right;">
                                <i class="fas fa-plus"></i> 開く
                            </button>
                        </div>
                        <div id="register-form-wrapper" style="display: none;">
                            <form id="register-form">
                                <div class="form-group">
                                    <label for="register-name"><i class="fas fa-user-circle"></i> ユーザー名 (10文字以下)</label>
                                    <input type="text" id="register-name" required maxlength="10">
                                </div>
                                <div class="form-group">
                                    <label for="register-kaferId"><i class="fas fa-id-card"></i> KAFer ID (4桁の数字)</label>
                                    <input type="text" id="register-kaferId" required pattern="[0-9]{4}">
                                </div>
                                <div class="form-group">
                                    <label for="register-password"><i class="fas fa-key"></i> パスワード</label>
                                    <input type="password" id="register-password" required>
                                </div>
                                <button type="submit" class="btn btn-secondary"><i class="fas fa-user-plus"></i> アカウント作成</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- PWA install buttons/prompts -->
    <button id="installAppButton"><i class="fas fa-download"></i></button>
    <div id="ios-install-prompt">
        <button id="close-ios-prompt">&times;</button>
        ホーム画面に追加してアプリのように使えます。<br>
        共有 <i class="fas fa-share-square"></i> ボタンから「ホーム画面に追加」を選択してください。
    </div>

    <!-- Script paths updated for the new file structure -->
    <script src="assets/js/global.js"></script>
    <script src="assets/js/index.js"></script>
</body>
</html>