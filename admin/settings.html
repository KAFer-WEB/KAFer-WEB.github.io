<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>KAFer - サイト設定</title>
    
    <!-- Asset paths updated for the new file structure -->
    <link id="favicon" rel="icon" href="/assets/icons/icon.png" type="image/png">
    <link rel="stylesheet" href="/assets/css/global.css">
    <link rel="stylesheet" href="/assets/css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Manifest path should be absolute from the root directory -->
    <link rel="manifest" href="/manifest.webmanifest">
</head>
<body class="app-container admin-page">
    <header class="app-header">
        <div class="logo"><h1>KAFer Admin</h1></div>
        <div class="user-controls">
            <span class="user-info-header" id="header-user-info"></span>
            <button class="logout-btn" onclick="logoutUser()"><i class="fas fa-sign-out-alt"></i> ログアウト</button>
        </div>
    </header>
    
    <div class="main-content-wrapper">
        <!-- Sidebar Navigation for Desktop -->
        <aside class="sidebar">
            <nav id="admin-sidebar-nav">
                <!-- Sidebar content is generated by initializeAdminUI() in global.js -->
            </nav>
        </aside>
        
        <main class="container">
            <div id="message-area" class="message"></div>

            <div id="site-settings-section" class="content-section">
                <h2><i class="fas fa-cogs"></i> サイト設定</h2>
                
                <!-- Tab Navigation -->
                <div class="tab-navigation" id="settings-tab-nav">
                    <button class="tab-button active" data-target="general-settings-tab"><i class="fas fa-sliders-h"></i> 一般設定</button>
                    <button class="tab-button" data-target="activity-log-tab"><i class="fas fa-history"></i> アクティビティログ</button>
                </div>
                
                <div class="tab-content-wrapper" id="settings-tab-content">
                    <!-- General Settings Tab -->
                    <div id="general-settings-tab" class="tab-content" style="display: block;">
                        <h3>一般設定</h3>
                        <form id="config-form">
                            <div class="form-group"><label for="admin-email"><i class="fas fa-at"></i> 管理者Eメール (通知用)</label><input type="email" id="admin-email" required></div>
                            <div class="form-group"><label for="admin-panel-password"><i class="fas fa-user-secret"></i> 新しい管理者パスワード (KAFerID '2025')</label><input type="password" id="admin-panel-password" required></div>
                            <div class="form-group"><label for="base-monthly-fee-input"><i class="fas fa-yen-sign"></i> 基本月額会費 (円)</label><input type="number" id="base-monthly-fee-input" required min="0" step="100" value="1000"></div>
                            <button type="submit" class="btn btn-secondary"><i class="fas fa-save"></i> 設定を保存</button>
                        </form>
                        
                        <h3 style="margin-top: var(--spacing-xxl);">緊急情報保護モード</h3>
                        <div class="card">
                            <div class="list-group">
                                <div class="list-group-item"><span>現在のステータス:</span><span id="site-setting-emergency-lockdown-status" style="font-weight: bold; color: var(--success-color);">無効</span></div>
                            </div>
                            <div class="action-buttons" style="margin-top: var(--spacing-lg);">
                                <button class="btn btn-danger" onclick="handleToggleEmergencyLockdown(true);"><i class="fas fa-lock"></i> 保護モードを有効にする</button>
                                <button class="btn btn-success" onclick="handleToggleEmergencyLockdown(false);"><i class="fas fa-unlock"></i> 保護モードを無効にする</button>
                            </div>
                            <div class="emergency-info">
                                <p><i class="fas fa-info-circle"></i> 保護モードを有効にすると、管理者以外の全ユーザーはログインできなくなり、データ閲覧も制限されます。</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Activity Log Tab -->
                    <div id="activity-log-tab" class="tab-content">
                        <h3>アクティビティログ</h3>
                        <div id="log-entries" class="log-container">
                            <div class="log-entry">
                                <i class="fas fa-info-circle"></i> ログデータがここに表示されます。
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- App scripts -->
    <script src="/assets/js/global.js"></script>
    <script src="/assets/js/admin/settings.js"></script>
</body>
</html>
